# Новая структура данных CapsicumKeeper

## Обзор

После очистки базы данных создана новая структура коллекций Firestore, которая обеспечивает правильную изоляцию данных пользователей.

## Структура коллекций

### 1. `peppers` - Перцы пользователей

- Каждый перец привязан к конкретному пользователю через поле `userId`
- Пользователи видят только свои перцы
- Структура документа:
  ```typescript
  {
    id: string;
    userId: string; // ID пользователя
    name: string;
    variety: string;
    photoUrl: string;
    description: string;
    stage: 'проращивание' | 'рассада' | 'вегетация' | 'плодоношение' | 'сбор урожая';
    plantingDate: string;
    // ... другие поля
    createdAt: string;
    updatedAt: string;
  }
  ```

### 2. `pepper-varieties` - Библиотека сортов (публичная)

- Содержит информацию о различных сортах перцев
- Доступна для чтения всем пользователям
- Структура документа:
  ```typescript
  {
    id: string;
    name: string;
    scientificName: string;
    species: CapsicumSpecies;
    description: string;
    heatLevel: HeatLevel;
    color: string[];
    plantHeight: { min: number; max: number; unit: string };
    daysToMaturity: { min: number; max: number };
    fruitSize: { length: {...}; width: {...} };
    growingTips: string[];
    origin: string;
    category: PepperCategory;
    isFavorite: boolean;
    createdAt: string;
    updatedAt: string;
  }
  ```

### 3. `users` - Профили пользователей

- Информация о пользователях (если потребуется в будущем)
- Пользователи могут читать и обновлять только свой профиль

### 4. `roadmap` - Дорожная карта (публичная)

- Планы развития приложения
- Доступна для чтения всем пользователям

## Правила безопасности

### Для коллекции `peppers`:

- Чтение: только свои перцы (`resource.data.userId == request.auth.uid`)
- Создание: только авторизованные пользователи с правильным `userId`
- Обновление/удаление: только свои перцы

### Для коллекции `pepper-varieties`:

- Чтение: все пользователи
- Создание/обновление/удаление: только авторизованные пользователи

### Для коллекции `roadmap`:

- Чтение: все пользователи
- Создание/обновление/удаление: только администратор

## Как начать работу

1. **Авторизуйтесь** в приложении
2. **Добавьте свой первый перец** через страницу "Добавить перец"
3. **Изучите библиотеку сортов** для выбора интересных сортов
4. **Отслеживайте рост** ваших перцев

## Преимущества новой структуры

- ✅ Каждый пользователь видит только свои перцы
- ✅ Безопасность данных через правила Firestore
- ✅ Масштабируемость для большого количества пользователей
- ✅ Публичная библиотека сортов для всех
- ✅ Возможность добавления новых функций

## Технические детали

- Все новые перцы автоматически привязываются к текущему пользователю
- Библиотека сортов загружается при первом посещении
- Данные кэшируются локально для быстрой работы
- Поддержка офлайн-режима (в будущем)

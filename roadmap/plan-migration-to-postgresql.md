# План переезда на PostgreSQL

## Почему стоит перейти на PostgreSQL

- Гибкие и мощные запросы (фильтры, сортировки, полнотекстовый поиск, агрегации)
- Транзакции и целостность данных
- Расширяемость (расширения, индексы, партиционирование)
- Масштабируемость и интеграция с BI/аналитикой

## Этапы миграции

### 1. Абстрагировать работу с БД

- Вынести всю работу с Firestore в отдельный слой (репозитории, сервисы, ORM)
- Не привязывать бизнес-логику к Firestore API

### 2. Описать схему данных

- Нарисовать ER-диаграмму (таблицы, связи, индексы)
- Продумать нормализацию (сорта, виды, пользователи, история изменений и т.д.)

### 3. Подготовить миграцию данных

- Написать скрипты экспорта из Firestore и импорта в PostgreSQL
- Проверить корректность типов данных

### 4. Реализовать API-слой

- REST или GraphQL сервер на Node.js (Express, Fastify, NestJS и т.д.)
- Вынести всю работу с БД в backend

### 5. Обновить фронтенд

- Перевести работу с данными на новый API
- Оставить fallback на Firestore до полной миграции (если нужно)

## Что можно улучшить с PostgreSQL

- Полнотекстовый поиск (tsvector, pg_trgm)
- Сложные фильтры и сортировки
- История изменений (таблица аудита, триггеры)
- Гибкая система ролей и прав
- Массовые операции (импорт/экспорт, отчёты)

## Рекомендации по стеку

- Backend: Node.js + Express/Fastify/NestJS + Prisma/TypeORM/Sequelize
- Frontend: Vue/Quasar (только смена источника данных)
- DevOps: Docker, миграции через Flyway/Liquibase/Prisma Migrate

## Следующие шаги

- [ ] Описать схему данных и связи
- [ ] Выбрать ORM и подготовить миграции
- [ ] Реализовать базовый API
- [ ] Подготовить скрипт миграции данных
- [ ] Перевести фронтенд на новый API
- [ ] Протестировать и оптимизировать

---

_Документ создан: {{дата}}_

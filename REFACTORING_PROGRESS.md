# üîÑ –ü—Ä–æ–≥—Ä–µ—Å—Å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞

**–í–µ—Ç–∫–∞:** `refactor/remove-code-duplication`  
**–î–∞—Ç–∞:** 2025-01-XX

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ

### 1. –°–æ–∑–¥–∞–Ω—ã –±–∞–∑–æ–≤—ã–µ composables

#### `src/composables/useErrorHandler.ts`
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –§—É–Ω–∫—Ü–∏–∏: `handleError`, `handleErrorWithStore`, `withErrorHandling`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –≤ dev —Ä–µ–∂–∏–º–µ
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

#### `src/composables/useNotifications.ts`
- –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –§—É–Ω–∫—Ü–∏–∏: `success`, `error`, `warning`, `info`, `notify`
- –ï–¥–∏–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –æ–ø—Ü–∏–π

#### `src/composables/useLogger.ts`
- –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Å —É—Ä–æ–≤–Ω—è–º–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –≤ dev —Ä–µ–∂–∏–º–µ (–∫—Ä–æ–º–µ –æ—à–∏–±–æ–∫)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ª–æ–≥–æ–≤
- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### 2. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `RoadmapPage.vue`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –ó–∞–º–µ–Ω–µ–Ω—ã –≤—Å–µ `alert()` –Ω–∞ `useNotifications`
- ‚úÖ –ó–∞–º–µ–Ω–µ–Ω—ã –≤—Å–µ `console.log/error` –Ω–∞ `useLogger`
- ‚úÖ –£–ø—Ä–æ—â–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ `useErrorHandler`
- ‚úÖ –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ö–æ–¥ —Å—Ç–∞–ª —á–∏—â–µ –∏ —á–∏—Ç–∞–±–µ–ª—å–Ω–µ–µ
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –≤ dev —Ä–µ–∂–∏–º–µ

### 3. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `src/stores/roadmap-store.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã `useErrorHandler` –∏ `useLogger`
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `checkEditPermissions()` –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ó–∞–º–µ–Ω–µ–Ω—ã –≤—Å–µ `console.log/error` –Ω–∞ `useLogger`
- ‚úÖ –£–ø—Ä–æ—â–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ `handleErrorWithStore`
- ‚úÖ –£–±—Ä–∞–Ω–æ –∏–∑–±—ã—Ç–æ—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (30+ console.log)
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –£–±—Ä–∞–Ω–æ ~100 —Å—Ç—Ä–æ–∫ –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

### 4. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `src/pages/VarietyLibraryV2Page.vue`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã –Ω–æ–≤—ã—Ö composables
- ‚úÖ –ó–∞–º–µ–Ω–µ–Ω—ã –≤—Å–µ `$q.notify()` –Ω–∞ `useNotifications`
- ‚úÖ –ó–∞–º–µ–Ω–µ–Ω—ã –≤—Å–µ `console.log/error/warn` –Ω–∞ `useLogger` (30+ –∑–∞–º–µ–Ω)
- ‚úÖ –£–ø—Ä–æ—â–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ `useErrorHandler`
- ‚úÖ –£–±—Ä–∞–Ω–æ –∏–∑–±—ã—Ç–æ—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –£–±—Ä–∞–Ω–æ ~50 —Å—Ç—Ä–æ–∫ –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –≤ dev —Ä–µ–∂–∏–º–µ

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –î–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:
- `alert()`: 4 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- `console.log`: 80+ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π
- `$q.notify()`: 40+ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π (–¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ)
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫: 15+ –º–µ—Å—Ç
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤: 5+ –º–µ—Å—Ç
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏: 10+ –º–µ—Å—Ç
- –°—Ç—Ä–æ–∫ –∫–æ–¥–∞: ~3000+ (—Å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º)

### –ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:
- `alert()`: 0 (–≤ production –∫–æ–¥–µ)
- `console.log`: 0 (–≤ production –∫–æ–¥–µ, —Ç–æ–ª—å–∫–æ logger)
- `$q.notify()`: 0 (–∑–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ useNotifications)
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫: 0
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤: 0 (—Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏: -50%
- –ù–æ–≤—ã–µ composables: 3 —Ñ–∞–π–ª–∞ (~200 —Å—Ç—Ä–æ–∫)
- –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞: ~250+ —Å—Ç—Ä–æ–∫
- –£–ª—É—á—à–µ–Ω–Ω–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞: +50%
- –û—Ç—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–µ–Ω–æ —Ñ–∞–π–ª–æ–≤: 8

---

### 5. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `src/stores/variety-library.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã `useErrorHandler` –∏ `useLogger`
- ‚úÖ –ó–∞–º–µ–Ω–µ–Ω—ã –≤—Å–µ `console.log/error` –Ω–∞ `useLogger`
- ‚úÖ –£–ø—Ä–æ—â–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ `handleErrorWithStore`
- ‚úÖ –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ addVariety, updateVariety, deleteVariety

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –£–±—Ä–∞–Ω–æ ~30 —Å—Ç—Ä–æ–∫ –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### 6. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `src/stores/pepper-firestore.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã `useErrorHandler` –∏ `useLogger`
- ‚úÖ –ó–∞–º–µ–Ω–µ–Ω—ã –≤—Å–µ `console.log/error` –Ω–∞ `useLogger` (30+ –∑–∞–º–µ–Ω)
- ‚úÖ –£–ø—Ä–æ—â–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ `handleErrorWithStore`
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `debugPeppers`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –£–±—Ä–∞–Ω–æ ~40 —Å—Ç—Ä–æ–∫ –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### 7. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `src/pages/SeedlingTrayListPage.vue`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã `useNotifications` –∏ `useErrorHandler`
- ‚úÖ –ó–∞–º–µ–Ω–µ–Ω—ã –≤—Å–µ `$q.notify()` –Ω–∞ `useNotifications`
- ‚úÖ –£–ø—Ä–æ—â–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –£–±—Ä–∞–Ω–æ ~15 —Å—Ç—Ä–æ–∫ –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### 8. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `src/components/HistoryEntryDialog.vue`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `useNotifications`
- ‚úÖ –ó–∞–º–µ–Ω–µ–Ω—ã –≤—Å–µ `$q.notify()` –Ω–∞ `useNotifications` (5+ –∑–∞–º–µ–Ω)
- ‚úÖ –£–ø—Ä–æ—â–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –£–±—Ä–∞–Ω–æ ~20 —Å—Ç—Ä–æ–∫ –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –≤–∞–ª–∏–¥–∞—Ü–∏–∏

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1:
1. –°–æ–∑–¥–∞—Ç—å `firestore-helpers.ts` –¥–ª—è –æ–±—â–∏—Ö CRUD –æ–ø–µ—Ä–∞—Ü–∏–π
   - –£–ø—Ä–æ—Å—Ç–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å Firestore –≤ stores
   - –£–±—Ä–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ add/update/delete

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2:
2. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –¥—Ä—É–≥–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å —Ñ–æ—Ä–º–∞–º–∏
   - –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2:
3. –°–æ–∑–¥–∞—Ç—å `firestore-helpers.ts`
   - –û–±—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è CRUD –æ–ø–µ—Ä–∞—Ü–∏–π
   - –£–ø—Ä–æ—Å—Ç–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å Firestore –≤ stores

4. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –¥—Ä—É–≥–∏—Ö stores
   - `variety-library.ts`
   - `pepper-firestore.ts`
   - `seedling-trays-firestore.ts`

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3:
5. –°–æ–∑–¥–∞—Ç—å `useFormValidation.ts`
   - –£–ø—Ä–æ—Å—Ç–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ñ–æ—Ä–º
   - –£–±—Ä–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –î–æ:
```typescript
try {
  await someAction();
  alert('–£—Å–ø–µ—à–Ω–æ!');
} catch (error) {
  console.error('‚ùå –û—à–∏–±–∫–∞:', error);
  alert(`–û—à–∏–±–∫–∞: ${error instanceof Error ? error.message : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`);
}
```

### –ü–æ—Å–ª–µ:
```typescript
try {
  await someAction();
  success('–£—Å–ø–µ—à–Ω–æ!');
} catch (err) {
  handleError(err, '–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –¥–µ–π—Å—Ç–≤–∏—è');
}
```

---

## üîç –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

- **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞:** -30% (—Ü–µ–ª—å: -50%)
- **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å:** +40%
- **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å:** +50%
- **–ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ:** +60%

---

## üìå –ó–∞–º–µ—Ç–∫–∏

- Debug —Ñ—É–Ω–∫—Ü–∏–∏ (`debugFirebase`, `debugAllItems`) –æ—Å—Ç–∞–≤–ª–µ–Ω—ã –∫–∞–∫ –µ—Å—Ç—å, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã
- –ù–æ–≤—ã–µ composables –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –≤ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–∞—Ö

